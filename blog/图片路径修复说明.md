# Hugo 图片路径问题修复

## 🔴 问题描述

在文章中引用同目录下 `vx_images` 文件夹中的图片时，生成的HTML中图片路径错误，导致图片无法显示。

### 问题示例

**文章位置**：`content/posts/运维/Linux服务器中git出现大量问号的问题解决.md`
**图片位置**：`content/posts/运维/vx_images/462725793899563_1.png`
**Markdown中引用**：`![图片](vx_images/462725793899563_1.png)`

### 生成后的问题

**页面生成位置**：`/posts/运维/linux服务器中git出现大量问号的问题解决/index.html`
**HTML中图片路径**：`src="vx_images/462725793899563_1.png"`（相对路径）
**浏览器解析为**：`/posts/运维/linux服务器中git出现大量问号的问题解决/vx_images/462725793899563_1.png` ❌
**实际图片位置**：`/posts/运维/vx_images/462725793899563_1.png` ✅

**结果**：404 - 图片不存在

## ✅ 解决方案

在Markdown文件中，使用 `../vx_images/...` 引用图片，返回上一级目录。

### 修改前
```markdown
![Linux服务器中git命令终端渲染出现问号](vx_images/107905629951159_1.png)
```

### 修改后
```markdown
![Linux服务器中git命令终端渲染出现问号](../vx_images/107905629951159_1.png)
```

## 📁 已修复的文件

### 1. 运维目录（`content/posts/运维/`）

**文件**：`Linux服务器中git出现大量问号的问题解决.md`
- 图片引用：2处
- 状态：✅ 已修复

**文件**：`0408异常问题排查.md`
- 图片引用：3处
- 状态：✅ 已修复

### 2. tmp目录（`content/posts/tmp/`）

**文件**：`Answer U_1.md`
- 图片引用：2处
- 状态：✅ 已修复

**文件**：`关于亿竞端游英雄联盟1v1技术规划.md`
- 图片引用：3处
- 状态：✅ 已修复

**文件**：`智能客服项目规划.md`
- 图片引用：2处
- 状态：✅ 已修复

## 🔍 原理说明

### Hugo的文章URL生成规则

Hugo为每篇文章生成独立的目录：

```
content/posts/运维/文章.md  →  public/posts/运维/文章/index.html
```

### 相对路径解析

当在HTML中使用相对路径时，路径是相对于**当前HTML文件**的位置：

| 当前页面 | 图片引用 | 实际解析路径 |
|---------|---------|------------|
| `/posts/运维/文章/index.html` | `vx_images/1.png` | `/posts/运维/文章/vx_images/1.png` ❌ |
| `/posts/运维/文章/index.html` | `../vx_images/1.png` | `/posts/运维/vx_images/1.png` ✅ |

### 目录结构对比

**源文件结构**：
```
content/posts/运维/
├── Linux服务器中git出现大量问号的问题解决.md
└── vx_images/
    └── 462725793899563_1.png
```

**生成后结构**：
```
public/posts/运维/
├── linux服务器中git出现大量问号的问题解决/
│   └── index.html  ← 页面在这里，需要用 ../ 返回上级
└── vx_images/
    └── 462725793899563_1.png  ← 图片在这里
```

## 📊 验证结果

重新生成网站后：
```bash
cd /data/hugo-blog
docker run --rm -v $(pwd)/blog:/hugo-site hugo-blog hugo --cleanDestinationDir
```

**统计信息**：
- 总页面：251
- 分页数：14
- 非页面文件：190（包含图片）
- 静态文件：42

**图片路径验证**：
```html
<!-- 修复后的HTML -->
<img src="../vx_images/107905629951159_1.png" alt="Linux服务器中git命令终端渲染出现问号">
<img src="../vx_images/462725793899563_1.png" alt="解决Linux服务器中git命令终端渲染出现问号">
```

**浏览器访问**：
- 原错误路径：`https://liupengliang.com/posts/运维/linux服务器中git出现大量问号的问题解决/vx_images/462725793899563_1.png` ❌
- 修复后路径：`https://liupengliang.com/posts/运维/vx_images/462725793899563_1.png` ✅

## 💡 最佳实践建议

### 方案1：使用相对路径（当前方案）✅
**适用场景**：图片在同一目录下的子文件夹中
**优点**：简单、不需要修改目录结构
**缺点**：需要手动维护相对路径

### 方案2：使用Page Bundle
将每篇文章和其图片放在独立目录中：
```
content/posts/运维/
└── linux服务器中git出现大量问号的问题解决/
    ├── index.md
    └── vx_images/
        └── 462725793899563_1.png
```
然后在文章中直接引用：`![图片](vx_images/462725793899563_1.png)`

**优点**：图片和文章关联更紧密
**缺点**：需要重组目录结构

### 方案3：使用static目录
将图片放到 `static/images/` 目录：
```
static/images/运维/
└── 462725793899563_1.png
```
在文章中使用绝对路径：`![图片](/images/运维/462725793899563_1.png)`

**优点**：路径固定，不受文章URL影响
**缺点**：图片和文章分离，不便于管理

## ✅ 修复完成

所有引用 `vx_images` 的文章已全部修复，图片现在可以正常显示。

---
修复时间：2025-10-21
修复文件数：5个
修复图片引用数：12处

